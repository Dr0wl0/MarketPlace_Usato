<div class="view-toggle">
  <button (click)="currentView = 'list'">Visualizza annunci</button>
  <button (click)="currentView = 'form'">Nuovo annuncio</button>
</div>

<hr />


<div class="container" *ngIf="currentView === 'list'">
  <h2>Lista Annunci</h2>
  <br /><br />

  <div class="filter">
    <label for="categoryFilter">Filtra per categoria:</label>
    <select id="categoryFilter" [(ngModel)]="selectedCategory">
      <option [ngValue]="null">Tutte le categorie</option>
      <option *ngFor="let cat of (categoryLabels | keyvalue)" [ngValue]="cat.key">
        {{ cat.value }}
      </option>
    </select>
  </div>

  <hr />

  <div *ngIf="filteredAnnunci.length > 0; else noAnnunci">
    <ul>
      <li *ngFor="let annuncio of filteredAnnunci">
        <strong>{{ annuncio.listingName
     }}</strong> -
        Categoria: {{ getCategoryLabel(annuncio.category) }}<br />
        Descrizione: {{ annuncio.description }}<br />
        Prezzo: €{{ annuncio.price }}<br />

        <button (click)="toggleFavourite(annuncio)">
          {{ annuncio.favourite ? '⭐ Rimuovi preferito' : '☆ Aggiungi ai preferiti' }}
        </button>
        <hr />
      </li>
    </ul>
  </div>

  <ng-template #noAnnunci>
    <p>Nessun annuncio disponibile per la categoria selezionata.</p>
  </ng-template>
</div>


<div *ngIf="currentView === 'form'">
  <h2>Nuovo Annuncio</h2>
  <br /><br />
  
  <label for="annuncio.listingName">Nome:</label>
  <input id="annuncio.listingName" [(ngModel)]="newAnnuncio.listingName" placeholder="Inserisci nome annuncio" />

  <label for="annuncio-description">Descrizione:</label>
  <input id="annuncio-description" [(ngModel)]="newAnnuncio.description" placeholder="Inserisci descrizione" />

  <label for="annuncio-price">Prezzo (€):</label>
  <input id="annuncio-price" type="number" [(ngModel)]="newAnnuncio.price" placeholder="Inserisci prezzo" />

  <label for="category-select">Categoria:</label>
  <select id="category-select" [(ngModel)]="newAnnuncio.category">
    <option *ngFor="let categoryKey of (categoryLabels | keyvalue)" [value]="categoryKey.key">
      {{ categoryKey.value }}
    </option>
  </select>

  <br /><br />
  <button (click)="publishAnnuncio()">Pubblica Annuncio</button>
</div>
